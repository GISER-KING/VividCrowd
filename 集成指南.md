# 数字面试官模块集成指南

## 一、后端集成步骤

### 1.1 数据库迁移（必须执行）

按顺序运行以下迁移脚本：

```bash
# 1. 创建简历相关表
python -m backend.migrations.add_resume_tables

# 2. 扩展评分维度
python -m backend.migrations.add_evaluation_dimensions

# 3. 添加简历关联字段
python -m backend.migrations.add_resume_to_interview_session

# 4. 添加评分模板字段
python -m backend.migrations.add_scoring_template_field

# 5. 创建模板表
python -m backend.migrations.create_template_tables

# 6. 添加重录字段
python -m backend.migrations.add_retry_fields

# 7. 创建候选人表
python -m backend.migrations.create_candidates_table
```

### 1.2 环境配置

在 `.env` 文件中添加：

```bash
# 数据加密密钥
ENCRYPTION_KEY=your-secret-key-here

# 文件上传目录
UPLOAD_DIR=backend/data/interviewer_uploads
```

### 1.3 依赖安装

```bash
pip install cryptography pymupdf python-docx pillow pandas openpyxl
```

---

## 二、前端集成步骤

### 2.1 组件导入

在需要使用的页面中导入组件：

```jsx
// 进度显示
import InterviewProgress from '@/components/digital_interviewer/InterviewProgress';

// 重录按钮
import RetryRecordButton from '@/components/digital_interviewer/RetryRecordButton';

// 准备指南
import InterviewPreparationGuide from '@/components/digital_interviewer/InterviewPreparationGuide';

// 批量导入
import BatchImportCandidates from '@/components/digital_interviewer/BatchImportCandidates';

// 数据导出
import ExportDataButton from '@/components/digital_interviewer/ExportDataButton';

// 风险提示
import ResumeRiskAlert from '@/components/digital_interviewer/ResumeRiskAlert';
```

### 2.2 在面试页面中使用进度组件

在 `DigitalInterviewerPage.jsx` 中添加：

```jsx
// 在面试进行中显示进度
{sessionData && (
  <InterviewProgress
    currentRound={sessionData.current_round}
    maxRounds={sessionData.max_rounds}
    elapsedSeconds={elapsedTime}
    status={sessionData.status}
  />
)}
```

### 2.3 在面试页面中使用重录按钮

```jsx
// 在每个问题下方添加重录按钮
<RetryRecordButton
  roundNumber={currentRound}
  retryCount={roundData?.retry_count || 0}
  maxRetries={2}
  onRetry={handleRetry}
  disabled={isRecording}
/>
```

### 2.4 在面试开始前显示准备指南

```jsx
// 在开始面试前显示准备指南
{showPreparation && (
  <InterviewPreparationGuide
    onComplete={() => {
      setShowPreparation(false);
      startInterview();
    }}
  />
)}
```

---

## 三、API接口使用说明

### 3.1 简历管理API

**上传简历：**
```javascript
POST /api/digital-interviewer/resumes/upload
Content-Type: multipart/form-data

FormData:
- file: 简历文件
- candidate_name: 候选人姓名
- candidate_id: 候选人ID
```

**获取简历列表：**
```javascript
GET /api/digital-interviewer/resumes?skip=0&limit=20
```

**获取简历详情：**
```javascript
GET /api/digital-interviewer/resumes/{resume_id}
```
